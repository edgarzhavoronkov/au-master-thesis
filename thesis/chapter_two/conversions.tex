\subsection{Преобразования между представлениями}

В этом разделе мы опишем преобразования между представлениями и начнем с преобразования именованных термов в неименованные. Очевидно, что для осуществления этого нам необходимо знать порядок на переменных в терме. Поэтому мы считаем, что кроме самого терма нам дают контекст.

\begin{definition}
  \textbf{Контекст} $\Gamma$ -- это не содержащий дубликатов список переменных $x_{1}, \dots x_{n}$, $x_{i} \in \mathcal{V}$.
\end{definition}

\begin{definition}
  Терм $T$ определен в контексте $\Gamma$ тогда и только тогда, когда все свободные переменные терма $T$ присутствуют в $\Gamma$. Этот факт традиционно обозначается как $\Gamma \vdash T$.
\end{definition}

Итак, преобразование $\Phi$ именованных термов в неименованные принимает на вход контекст $\Gamma = x_{1}, \dots, x_{n}$, терм $T \in \Lambda$  такой что он определен в контексте $\Gamma$ и возвращает неименованный терм $T' \in \Lambda_{n}$. Определяется оно индукцией по структуре терма $T$:

\begin{enumerate}
  \item $x_{1}, \dots, x_{n} \vdash x_{i} \mapsto v_{n, n - i}$
  \item $x_{1}, \dots, x_{n} \vdash M N \mapsto \Phi(x_{1}, \dots, x_{n} \vdash M)\ \Phi(x_{1}, \dots, x_{n} \vdash N)$
  \item $x_{1}, \dots, x_{n} \vdash \lambda x.M \mapsto \lambda \Phi(x_{1}, \dots, x_{n} \cup \{x\} \vdash M)$
\end{enumerate}

Покажем, что такое преобразование уважает отношение $\alpha$-эквивалентности, введенное в разделе~\ref{sec:named}.

\begin{prop}
  Пусть $T_{1}, T_{2} \in \Lambda$, $\Gamma \vdash T_{1}$, $\Gamma \vdash T_{2}$ и $T_{1} \alphaeq T_{2}$. Тогда $\Phi(\Gamma \vdash T_{1}) = \Phi(\Gamma \vdash T_{2})$.
\end{prop}

\begin{proof}
  Индукция по термам $T_{1}$ и $T_{2}$. Так как мы знаем, что они $\alpha$-эквивалентны, то нам нет необходимости рассматривать всевозможные комбинации термов. Поэтому рассмотрим лишь случаи, когда термы имеют общую структуру(две переменные, две аппликации или две абстракции).

  База индукции для случая двух переменных тривиальна, как и случай для двух аппликаций. Рассмотрим случай, когда $T_{1} = \lambda x.M$, $T_{2} = \lambda y.M'$. Так как они $\alpha$-эквивалентны, то мы знаем, что $M' \alphaeq M[x \mapsto y]$ и $y \notin FV(M)$. Мы знаем, что $\Gamma \vdash \lambda x.M$ и $\Gamma \vdash \lambda y.M'$, следовательно $\Gamma \cup \{x\} \vdash M$ и $\Gamma \cup \{y\} \vdash M'$. Кроме того, так как $y \notin FV(M)$, то $\Gamma \cup \{y\} \vdash M[x \mapsto y]$. По индукционной гипотезе мы знаем, что $M' \alphaeq M[x \mapsto y]$, а так как они определены в одинаковых контекстах, то и $\Phi(\Gamma \cup \{y\} \vdash M') = \Phi(\Gamma \cup \{y\} \vdash M[x \mapsto y])$. Отсюда получаем требуемое.
\end{proof}

Легко сконструировать преобразование в обратную сторону -- из неименованных термов в именованные. Кроме того, легко показать, что они взаимно-обратны.

Аналогичным образом легко сконструировать преобразования между неименованными и монадическими термами. Так же, довольно легко показать, что они взаимно-обратны.
